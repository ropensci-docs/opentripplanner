<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="opentripplanner">
<title>Known Issues • opentripplanner</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Known Issues">
<meta property="og:description" content="opentripplanner">
<meta property="og:image" content="https://docs.ropensci.org/opentripplanner/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">opentripplanner</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.5.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/opentripplanner.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Analyst.html">Analyst</a>
    <a class="dropdown-item" href="../articles/OTPv2.html">OpenTripPlanner Version 2</a>
    <a class="dropdown-item" href="../articles/advanced_features.html">Advanced Features</a>
    <a class="dropdown-item" href="../articles/known_issues.html">Known Issues</a>
    <a class="dropdown-item" href="../articles/prerequisites.html">Prerequisites</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/opentripplanner/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Known Issues</h1>
                        <h4 data-toc-skip class="author">Malcolm Morgan</h4>
            
            <h4 data-toc-skip class="date">2024-03-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/opentripplanner/blob/HEAD/vignettes/known_issues.Rmd" class="external-link"><code>vignettes/known_issues.Rmd</code></a></small>
      <div class="d-none name"><code>known_issues.Rmd</code></div>
    </div>

    
    
<p>This vignette highlights some known limitations or bugs with OpenTripPlanner as well as suggested solutions.</p>
<div class="section level2">
<h2 id="getting-help-and-reporting-bugs">Getting help and reporting bugs<a class="anchor" aria-label="anchor" href="#getting-help-and-reporting-bugs"></a>
</h2>
<div class="section level3">
<h3 id="opentripplanner">OpenTripPlanner<a class="anchor" aria-label="anchor" href="#opentripplanner"></a>
</h3>
<ul>
<li><a href="https://groups.google.com/forum/#!forum/opentripplanner-users" class="external-link">OTP Users Group</a></li>
<li><a href="https://github.com/opentripplanner/OpenTripPlanner/issues" class="external-link">OTP GitHub Issues</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="opentripplanner-for-r">OpenTripPlanner for R<a class="anchor" aria-label="anchor" href="#opentripplanner-for-r"></a>
</h3>
<ul>
<li><a href="https://github.com/ropensci/opentripplanner/issues" class="external-link">OTP GitHub Issues</a></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="reasons-for-graph-building-to-fail">Reasons for Graph building to Fail<a class="anchor" aria-label="anchor" href="#reasons-for-graph-building-to-fail"></a>
</h2>
<p>The <code><a href="../reference/otp_build_graph.html">otp_build_graph()</a></code> function returns the log from OTP, so the reasons for failures should be documented in the log. Common problems include.</p>
<div class="section level3">
<h3 id="cant-allocate-memory">Can’t allocate memory<a class="anchor" aria-label="anchor" href="#cant-allocate-memory"></a>
</h3>
<p>If you get the error:</p>
<p><code>Invalid maximum heap size: The specified size exceeds the maximum representable size.</code></p>
<p>Then the <code>memory</code> argument in <code><a href="../reference/otp_build_graph.html">otp_build_graph()</a></code> is too large. This may be because you have set it to more than the amount of RAM on your computer or because you have the 32 bit version of Java rather than the 64 Bit version installed.</p>
</div>
<div class="section level3">
<h3 id="ran-out-of-memory">Ran out of memory<a class="anchor" aria-label="anchor" href="#ran-out-of-memory"></a>
</h3>
<p>A graph build can fail due to lack of memory. You can increase the memory allocated using the <code>memory</code> argument in <code><a href="../reference/otp_build_graph.html">otp_build_graph()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="bad-input-data">Bad input data<a class="anchor" aria-label="anchor" href="#bad-input-data"></a>
</h3>
<p>If you have multiple input files (e.g. GTFS timetables, elevation, config files) and your graph build is failing, try removing all but the PBF file and seeing if the graph can now successfully build. If it does, add files one at a time until you find the file that is causing the build to fail.</p>
</div>
</div>
<div class="section level2">
<h2 id="reasons-for-routing-to-fail">Reasons for Routing to Fail<a class="anchor" aria-label="anchor" href="#reasons-for-routing-to-fail"></a>
</h2>
<p>If you find OTP can not find a route here are some common reasons to check:</p>
<div class="section level3">
<h3 id="start-or-end-is-too-far-from-the-road-network">Start or End is too far from the road network<a class="anchor" aria-label="anchor" href="#start-or-end-is-too-far-from-the-road-network"></a>
</h3>
<p>OTP will snap fromPlace and toPlace coordinates to the road network, but only for a limited distance. If your points are far from the road network (e.g. in a lake or middle of a park) then OTP will fail to find a route.</p>
</div>
<div class="section level3">
<h3 id="mode-specific-limits">Mode Specific Limits<a class="anchor" aria-label="anchor" href="#mode-specific-limits"></a>
</h3>
<p>OTP does not support all mode combinations (e.g. walk + drive) so some places may only be accessible by certain modes. For example, you can’t walk on a motorway or drive on a path. Use the debug layers to check for mode restrictions.</p>
</div>
<div class="section level3">
<h3 id="maximum-walk-to-transit">Maximum walk to transit<a class="anchor" aria-label="anchor" href="#maximum-walk-to-transit"></a>
</h3>
<p>By default, OTP caps the maximum walking distance to a transit stop at a low level, so some areas are unreachable by transit. Increase the maximum walking distance to get better results.</p>
</div>
<div class="section level3">
<h3 id="driving-on-roads-with-cycleway-tag">Driving on Roads with cycleway tag<a class="anchor" aria-label="anchor" href="#driving-on-roads-with-cycleway-tag"></a>
</h3>
<p>A known bug that stops driving on any road with cycling infrastructure. <a href="https://groups.google.com/forum/#!topic/opentripplanner-users/BOv1J32k6Sc" class="external-link uri">https://groups.google.com/forum/#!topic/opentripplanner-users/BOv1J32k6Sc</a></p>
</div>
<div class="section level3">
<h3 id="multicore-instability">Multicore instability<a class="anchor" aria-label="anchor" href="#multicore-instability"></a>
</h3>
<p>If you get the error:</p>
<p><code>Error in unserialize(socklist[[n]]) : error reading from connection</code></p>
<p>It means that one of the parallel workers has crashed. Try running your routing in smaller batches like this:</p>
<p>This code will break the routing into 5 batches and put the results into a list called <code>routes_list</code> before binding them together into the finished <code>routes</code> data frame.</p>
<pre><code><span><span class="va">routes_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fromPlace</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fromPlace</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">vals</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">routes_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/otp_plan.html">otp_plan</a></span><span class="op">(</span><span class="va">otpcon</span>,</span>
<span>                        fromPlace <span class="op">=</span> <span class="va">fromPlace</span><span class="op">[</span><span class="va">vals</span>,<span class="op">]</span>,</span>
<span>                        toPlace <span class="op">=</span> <span class="va">toPlace</span><span class="op">[</span><span class="va">vals</span>,<span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">routes_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">routes_sub</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">routes</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">bind_rows</span><span class="op">(</span><span class="va">routes_list</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="speeding-up-routing">Speeding up routing<a class="anchor" aria-label="anchor" href="#speeding-up-routing"></a>
</h2>
<p>If you are doing a large amount of routing consider the following options.</p>
<ol style="list-style-type: decimal">
<li>Use multicore routing using <code>ncores</code> argument of <code><a href="../reference/otp_plan.html">otp_plan()</a></code>
</li>
<li>Reduce the area, for example, if you are only routing in one city you don’t need a whole country graph.</li>
<li>Remove unneeded roads using <a href="https://wiki.openstreetmap.org/wiki/Osmfilter" class="external-link">osmfilter</a> or <a href="https://github.com/ITSLeeds/OSMtools" class="external-link">OSMtools</a> for example if you are only interested in driving you can remove footpaths and cycleways. This will simplify your graph and provide a small performance boost.</li>
<li>Upgrading your computer, a new fast CPU with more cores will route faster.</li>
</ol>
</div>
<div class="section level2">
<h2 id="gtfs-data-for-the-uk">GTFS Data for the UK<a class="anchor" aria-label="anchor" href="#gtfs-data-for-the-uk"></a>
</h2>
<p>See <a href="https://github.com/ITSLeeds/UK2GTFS" class="external-link uri">https://github.com/ITSLeeds/UK2GTFS</a></p>
</div>
<div class="section level2">
<h2 id="elevation-data">Elevation Data<a class="anchor" aria-label="anchor" href="#elevation-data"></a>
</h2>
<p>It is common for GeoTIFF to have a no data value often the maximum possible value. OTP can misinterpret this as an elevation value. So set your no data values in your elevation data to something more plausible like 0.</p>
<p>Note that OTP does not support all types of GeoTIFF compression so you may have to change the compression type of the image if you are experiencing problems.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
